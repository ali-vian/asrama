<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <link href="./css/output.css" rel="stylesheet" />
  </head>
  <body class="bg-gray-200 font-sans leading-normal tracking-normal">
    <!-- Sidebar -->
    <div class="flex">
      <aside class="w-64 bg-white text-black min-h-screen stroke-black">
        <div class="p-6">
          <img class="h-24" src="../img/asrama utm (1).png" alt="asrama" />
          <nav class="mt-8">
            <a
              href="absensi_harian.html"
              class="block py-2.5 px-4 rounded hover:bg-gray-700"
              >Jamaah Wajib</a
            >
            <a href="#" class="block py-2.5 px-4 rounded hover:bg-gray-700"
              >Liqoan</a
            >
            <a
              href="tahajud.html"
              class="block py-2.5 px-4 rounded hover:bg-gray-700"
              >Tahajud</a
            >
            <a
              href="kajian.html"
              class="block py-2.5 px-4 rounded hover:bg-gray-700"
              >Kajian</a
            >
            <a
              href="index.html"
              class="block py-2.5 px-4 rounded bg-red-700 text-white hover:bg-red-500"
              >Kembali</a
            >
          </nav>
        </div>
      </aside>

      <!-- Main Content -->
      <div class="flex-1 p-6">
        <!-- Header -->
        <header class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-semibold text-gray-800">Absensi Harian</h2>
          <div class="flex items-center">
            <span class="mr-4">Admin</span>
            <img
              class="w-10 h-10 rounded-full"
              src="https://via.placeholder.com/40"
              alt="profile photo"
            />
          </div>
        </header>
        <!-- ubah ke pdf atau excel -->
        <button
          onclick="printPDF()"
          class="bg-blue-500 text-white px-4 py-2 rounded mb-4"
        >
          Cetak PDF
        </button>
        <button
          onclick="exportToExcel()"
          class="bg-green-500 text-white px-4 py-2 rounded mb-4"
        >
          Cetak Excel
        </button>

        <!-- Additional Content or Tables -->
        <div class="pdf_magrib bg-white p-6 rounded-lg shadow-lg mb-10">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-semibold text-gray-800">LIQOAN</h3>
            <input
              type="text"
              placeholder="Cari..."
              class="border border-gray-300 rounded px-3 py-1 text-gray-700 focus:outline-none focus:border-blue-500"
            />
          </div>
          <table class="min-w-full bg-white border">
            <div>
              <a
                href="#"
                class="text-3xl font-bold border-2 border-gray-400 px-4 py-2 inline-flex items-center justify-center hover:border-blue-500 hover:bg-blue-50 transition"
                >+</a
              >
            </div>

            <thead>
              <tr>
                <th class="py-2 px-4 bg-gray-200">Date</th>
                <th class="py-2 px-4 bg-gray-200">Nama</th>
                <th class="py-2 px-4 bg-gray-200">Nim</th>
                <th class="py-2 px-4 bg-gray-200">Nomor Kamar</th>
                <th class="py-2 px-3 bg-gray-200">Musahil Pendamping</th>
                <th class="py-2 px-4 bg-gray-200">Status</th>
                <th class="py-2 px-4 bg-gray-200">Edit</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="py-2 px-4">10/10/2024</td>
                <td class="py-2 px-2">Fatta Khurrazaq</td>
                <td class="py-2 px-2">220411100077</td>
                <td class="py-2 px-9">206</td>
                <td class="py-2 px-10">Putra</td>
                <td class="py-2 px-7 text-red-500">Alpha</td>
              </tr>
              <tr>
                <td class="py-2 px-4">10/10/2024</td>
                <td class="py-2 px-2">Fatta Khurrazaq</td>
                <td class="py-2 px-2">220411100077</td>
                <td class="py-2 px-9">206</td>
                <td class="py-2 px-10">Putra</td>
                <td class="py-2 px-7 text-red-500">Alpha</td>
              </tr>
              <tr>
                <td class="py-2 px-4">10/10/2024</td>
                <td class="py-2 px-2">Fatta Khurrazaq</td>
                <td class="py-2 px-2">220411100077</td>
                <td class="py-2 px-9">206</td>
                <td class="py-2 px-10">Putra</td>
                <td class="py-2 px-7 text-red-500">Alpha</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

    <script>
      function printPDF() {
        const element = document.querySelector(".pdf_magrib");
        html2pdf()
          .set({
            margin: 0.5, // lebih kecil agar tabel cukup
            filename: "Sholat_Maghrib_Report.pdf",
            image: { type: "jpeg", quality: 0.98 },
            html2canvas: { scale: 3 }, // meningkatkan skala agar konten lebih tajam
            jsPDF: { unit: "in", format: "A4", orientation: "landscape" }, // ubah menjadi "landscape"
          })
          .from(element)
          .save();
      }
      function exportToExcel() {
        // Ambil elemen tabel
        const table = document.querySelector(".pdf_magrib");

        // Buat worksheet dari tabel HTML
        const workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });

        // Simpan sebagai file Excel
        XLSX.writeFile(workbook, "Sholat_Maghrib_Report.xlsx");
      }
    </script>
  </body>
</html>
